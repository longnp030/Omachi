(function(t){function e(e){for(var i,o,s=e[0],c=e[1],l=e[2],d=0,f=[];d<s.length;d++)o=s[d],Object.prototype.hasOwnProperty.call(a,o)&&a[o]&&f.push(a[o][0]),a[o]=0;for(i in c)Object.prototype.hasOwnProperty.call(c,i)&&(t[i]=c[i]);u&&u(e);while(f.length)f.shift()();return n.push.apply(n,l||[]),r()}function r(){for(var t,e=0;e<n.length;e++){for(var r=n[e],i=!0,s=1;s<r.length;s++){var c=r[s];0!==a[c]&&(i=!1)}i&&(n.splice(e--,1),t=o(o.s=r[0]))}return t}var i={},a={app:0},n=[];function o(e){if(i[e])return i[e].exports;var r=i[e]={i:e,l:!1,exports:{}};return t[e].call(r.exports,r,r.exports,o),r.l=!0,r.exports}o.m=t,o.c=i,o.d=function(t,e,r){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(o.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)o.d(r,i,function(e){return t[e]}.bind(null,i));return r},o.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],c=s.push.bind(s);s.push=e,s=s.slice();for(var l=0;l<s.length;l++)e(s[l]);var u=c;n.push([0,"chunk-vendors"]),r()})({0:function(t,e,r){t.exports=r("56d7")},"034f":function(t,e,r){"use strict";r("85ec")},"2d19":function(t,e,r){"use strict";r("9577")},4613:function(t,e,r){"use strict";r("4a3c")},"4a3c":function(t,e,r){},"51b5":function(t,e,r){},"56d7":function(t,e,r){"use strict";r.r(e);r("e260"),r("e6cf"),r("cca6"),r("a79d");var i=r("2b0e"),a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{attrs:{id:"app"}},[r("router-view")],1)},n=[],o={name:"app",components:{},created:function(){this.$router.push("home",(function(){}))}},s=o,c=(r("034f"),r("2877")),l=Object(c["a"])(s,a,n,!1,null,null,null),u=l.exports,d=r("8c4f"),f=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("v-app",{attrs:{id:"login","data-app":""}},[r("v-form",{ref:"form",staticClass:"login-form",attrs:{"lazy-validation":""},model:{value:t.valid,callback:function(e){t.valid=e},expression:"valid"}},[r("v-text-field",{attrs:{label:"Email",rules:[t.rules.required,t.rules.email]},model:{value:t.authModel.Email,callback:function(e){t.$set(t.authModel,"Email",e)},expression:"authModel.Email"}}),r("v-text-field",{attrs:{label:"Password",rules:[t.rules.required],type:"password"},model:{value:t.authModel.Password,callback:function(e){t.$set(t.authModel,"Password",e)},expression:"authModel.Password"}}),r("v-checkbox",{attrs:{color:"red",label:"Remember me"},model:{value:t.saveCred,callback:function(e){t.saveCred=e},expression:"saveCred"}}),r("v-btn",{staticClass:"mr-4",attrs:{disabled:!t.valid,color:"success"},on:{click:t.login}},[t._v(" Login ")]),r("v-btn",{staticClass:"mr-4",attrs:{color:"success"},on:{click:t.register}},[t._v(" Register ")])],1)],1)},v=[],h=r("bc3a"),m=r.n(h),p={name:"Login",data:function(){return{authUrl:"https://localhost:5001/Users/authenticate",valid:!0,saveCred:!1,rules:{required:function(t){return!!t||"Required."},email:function(t){var e=/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return e.test(t)||"Invalid email."}},authModel:{}}},mounted:function(){console.log(this.saveCred)},methods:{saveCookie:function(t,e,r){this.$cookies.set("omachi-auth-token",t,r),this.$cookies.set("omachi-user-id",e,r)},login:function(){var t=this;this.$refs.form.validate(),m.a.post(this.authUrl,JSON.parse(JSON.stringify(this.authModel))).then((function(e){var r=e.data.JwtToken,i=e.data.Id;console.log(t.saveCred),t.saveCred?t.saveCookie(r,i,-1):t.saveCookie(r,i,0),t.$nextTick((function(){this.$router.push({name:"home",params:{authToken:r,userId:i}})}))})).catch((function(t){console.log(t)}))},register:function(){this.$router.push("register")}},watch:{saveCred:function(){console.log("saveCred is set to: ",this.saveCred)}}},g=p,k=(r("7930"),Object(c["a"])(g,f,v,!1,null,"06cca53c",null)),b=k.exports,w=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("v-app",{attrs:{id:"register","data-app":""}},[r("v-form",{ref:"form",staticClass:"register-form",attrs:{"lazy-validation":""},model:{value:t.valid,callback:function(e){t.valid=e},expression:"valid"}},[r("v-text-field",{attrs:{label:"Email",rules:[t.rules.required,t.rules.email]},model:{value:t.registerModel.Email,callback:function(e){t.$set(t.registerModel,"Email",e)},expression:"registerModel.Email"}}),r("v-text-field",{attrs:{label:"Password",rules:[t.rules.required],type:"password"},model:{value:t.confirmPwd,callback:function(e){t.confirmPwd=e},expression:"confirmPwd"}}),r("v-text-field",{attrs:{label:"Confirm Password",rules:[t.rules.required,t.rules.matchPwd],type:"password"},model:{value:t.registerModel.Password,callback:function(e){t.$set(t.registerModel,"Password",e)},expression:"registerModel.Password"}}),r("v-checkbox",{attrs:{color:"red",rules:[function(t){return!!t||"You must agree to continue!"}],label:"I agree to the terms of services"}}),r("v-checkbox",{attrs:{color:"red",label:"Save credentials for next login."},model:{value:t.saveCred,callback:function(e){t.saveCred=e},expression:"saveCred"}}),r("v-btn",{staticClass:"mr-4",attrs:{disabled:!t.valid,color:"success"},on:{click:t.register}},[t._v(" Register ")])],1)],1)},y=[],_={name:"Register",data:function(){var t=this;return{registerUrl:"https://localhost:5001/Users/register",authUrl:"https://localhost:5001/Users/authenticate",valid:!0,saveCred:!1,registerModel:{},confirmPwd:"",rules:{required:function(t){return!!t||"Required."},email:function(t){var e=/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return e.test(t)||"Invalid email."},matchPwd:function(e){return e===t.confirmPwd||"Passwords do not match."}}}},methods:{saveCookie:function(t,e,r){this.$cookies.set("omachi-auth-token",t,r),this.$cookies.set("omachi-user-id",e,r)},register:function(){var t=this;this.$refs.form.validate(),m.a.post(this.registerUrl,JSON.parse(JSON.stringify(this.registerModel))).then((function(){var e={Email:t.registerModel.Email,Password:t.registerModel.Password};m.a.post(t.authUrl,e).then((function(e){var r=e.data.JwtToken,i=e.data.Id;t.saveCred?t.saveCookie(r,i,"7d"):t.saveCookie(r,i,0),t.$nextTick((function(){this.$router.push({name:"update-profile",params:{authToken:r,userId:i,userEmail:e.data.Email}})}))})).catch((function(t){console.log(t)}))})).catch((function(t){console.log(t)}))}}},x=_,M=(r("4613"),Object(c["a"])(x,w,y,!1,null,"6eaef396",null)),$=M.exports,T=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{attrs:{id:"home","data-app":""}},[r("div",{attrs:{id:"nav"}},[r("NavigationPanel",{on:{logout:t.logout}})],1),r("div",{attrs:{id:"map"}},[r("l-map",{attrs:{zoom:t.zoom,center:t.center},on:{click:t.addMarker}},[r("l-tile-layer",{attrs:{url:t.url,attribution:t.attribution}}),r("l-control",[r("v-btn",{on:{click:function(e){t.showActivities=!t.showActivities}}},[t._v(" Toggle activities route ")]),r("v-dialog",{attrs:{persistent:""},scopedSlots:t._u([{key:"activator",fn:function(e){var i=e.on,a=e.attrs;return[r("v-btn",t._g(t._b({on:{click:function(e){return t.addActivity(!t.dialog)}}},"v-btn",a,!1),i),[t._v(" Add activity ")])]}}]),model:{value:t.dialog,callback:function(e){t.dialog=e},expression:"dialog"}},[r("ActivityForm",{attrs:{user_id:t.userId,jwt_token:t.jwtToken,formMode:t.formMode,marker:t.new_marker,editMarkerId:t.editMarkerId},on:{addActivity:t.addActivity}})],1)],1),t._l(t.markers,(function(e){return r("l-marker",{key:e.Id,attrs:{"lat-lng":e.LatLon,visible:t.showActivities},on:{click:function(r){return t.editMarker(!t.dialog,e.Id)}}},[r("l-tooltip",[t._v(" Name: "+t._s(e.Name)+" "),r("br"),t._v(" StartTime:"+t._s(e.StartTime)+" ")])],1)})),r("l-polyline",{attrs:{"lat-lngs":t.polyline.latlons,color:t.polyline.color,visible:t.showActivities}})],2)],1)])},C=[],j=r("1da1"),A=(r("ac1f"),r("5319"),r("a434"),r("96cf"),function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{attrs:{id:"navigation-panel"}},[r("div",{staticClass:"left",attrs:{id:"logo"}}),r("div",{staticClass:"right"},[t._v(t._s(t.user)+" "),r("v-btn",{staticClass:"mr-4",attrs:{color:"success"},on:{click:t.logout}},[t._v(" Login ")])],1)])}),S=[],I={name:"NavigationPanel",data:function(){return{user:null}},created:function(){},methods:{logout:function(){this.$emit("logout")}}},P=I,O=(r("e065"),Object(c["a"])(P,A,S,!1,null,"74c8850a",null)),U=O.exports,L=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("v-card",[r("v-form",{ref:"form"},[r("v-card-title",[r("span",{staticClass:"text-h5"},[t._v("Add new activity")])]),r("v-card-text",[r("v-container",[r("v-row",[r("v-col",{attrs:{cols:"12"}},[r("v-text-field",{attrs:{label:"Name*",rules:[t.rules.required],required:""},model:{value:t.activity.Name,callback:function(e){t.$set(t.activity,"Name",e)},expression:"activity.Name"}})],1),r("v-col",{attrs:{cols:"12"}},[r("v-menu",{ref:"menu",attrs:{"close-on-content-click":!1,"nudge-right":40,"return-value":t.activity.StartTime,transition:"scale-transition","offset-y":"","max-width":"290px","min-width":"290px"},on:{"update:returnValue":function(e){return t.$set(t.activity,"StartTime",e)},"update:return-value":function(e){return t.$set(t.activity,"StartTime",e)}},scopedSlots:t._u([{key:"activator",fn:function(e){var i=e.on,a=e.attrs;return[r("v-text-field",t._g(t._b({attrs:{rules:[t.rules.required],label:"StartTime*",readonly:""},model:{value:t.activity.StartTime,callback:function(e){t.$set(t.activity,"StartTime",e)},expression:"activity.StartTime"}},"v-text-field",a,!1),i))]}}]),model:{value:t.menu2,callback:function(e){t.menu2=e},expression:"menu2"}},[t.menu2?r("v-time-picker",{attrs:{"full-width":"","use-seconds":""},on:{"click:second":function(e){return t.$refs.menu.save(t.activity.StartTime)}},model:{value:t.activity.StartTime,callback:function(e){t.$set(t.activity,"StartTime",e)},expression:"activity.StartTime"}}):t._e()],1)],1)],1)],1)],1),r("v-card-actions",[r("v-spacer"),r("v-btn",{attrs:{color:"blue darken-1",text:""},on:{click:t.cancelActivity}},[t._v(" Close ")]),r("v-btn",{attrs:{color:"blue darken-1",text:""},on:{click:t.saveActivity}},[t._v(" Save ")])],1)],1)],1)},q=[],E=(r("a9e3"),{name:"ActivityForm",components:{},data:function(){return{rules:{required:function(t){return!!t||"Required."}},menu2:!1,activity:{},add_act_url:"https://localhost:5001/Users/user_id/activities",get_act_url:"https://localhost:5001/Activities/act_id"}},props:{user_id:{type:String,required:!0,default:""},jwt_token:{type:String,required:!0,default:""},marker:{type:Object,required:!1,default:function(){return{}}},formMode:{type:Number,required:!0,default:1},editMarkerId:{type:String,required:!1,default:""}},methods:{cancelActivity:function(){this.activity={},this.$refs.form.reset(),this.$emit("addActivity",!1)},saveActivity:function(){this.$refs.form.validate(),this.marker.LatLon&&(this.activity.Lat=this.marker.LatLon[0],this.activity.Lon=this.marker.LatLon[1],console.log(this.activity))}},watch:{formMode:function(){console.log(this.formMode)},marker:function(){console.log(this.marker)},editMarkerId:function(){console.log(this.editMarkerId);var t=this;1==this.formMode&&m.a.get(this.get_act_url.replace("act_id",this.editMarkerId),{headers:{Authorization:"Bearer ".concat(this.jwt_token)}}).then((function(e){console.log(e),t.activity=e.data})).catch((function(t){console.log(t)}))}}}),R=E,N=(r("2d19"),Object(c["a"])(R,L,q,!1,null,"23067194",null)),z=N.exports,F={name:"Home",components:{NavigationPanel:U,ActivityForm:z},data:function(){return{getUserUrl:"https://localhost:5001/Users/",add_getall_actsUrl:"https://localhost:5001/Users/user_id/activities",jwtToken:"",user:null,userId:null,activities:null,showActivities:!0,url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",attribution:'&copy; <a target="_blank" href="http://osm.org/copyright">OpenStreetMap</a> contributors',zoom:15,center:[21.0422318,105.8342],markers:[],polyline:{latlons:[],color:"green"},dialog:!1,formMode:1,new_act_idx:0,new_marker:{},editMarkerId:""}},props:{},created:function(){this.jwtToken=this.$route.params.authToken,void 0===this.jwtToken&&(this.jwtToken=this.$cookies.get("omachi-auth-token"),null===this.jwtToken&&this.$router.push("login"))},mounted:function(){var t=this;return Object(j["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.getUser();case 2:return e.next=4,t.drawActivitiesRoute();case 4:case"end":return e.stop()}}),e)})))()},methods:{logout:function(){this.jwtToken=this.$cookies.get("omachi-auth-token"),null!==this.jwtToken&&this.$cookies.remove("omachi-auth-token"),this.$nextTick((function(){this.$router.push("login")}))},getUser:function(){var t=this;return Object(j["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.userId=t.$cookies.get("omachi-user-id"),null===t.userId){e.next=4;break}return e.next=4,m.a.get(t.getUserUrl+t.userId,{headers:{Authorization:"Bearer ".concat(t.jwtToken)}}).then((function(e){t.user=e.data})).catch((function(t){console.log(t)}));case 4:case"end":return e.stop()}}),e)})))()},getActivities:function(){var t=this;return Object(j["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,m.a.get(t.add_getall_actsUrl.replace("user_id",t.userId),{headers:{Authorization:"Bearer ".concat(t.jwtToken)}}).then((function(e){t.activities=e.data})).catch((function(t){console.log(t)}));case 2:case"end":return e.stop()}}),e)})))()},drawActivitiesRoute:function(){var t=this;return Object(j["a"])(regeneratorRuntime.mark((function e(){var r,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.getActivities();case 2:if(t.activities.length>1)for(r in t.activities)i=t.activities[r],t.markers.push({Index:r,Id:i.Id,LatLon:[i.Lat,i.Lon],Name:i.Name,StartTime:i.StartTime}),t.polyline.latlons.push([i.Lat,i.Lon]);else t.addActivites();case 3:case"end":return e.stop()}}),e)})))()},addActivity:function(t){this.dialog=t,this.formMode=0},addMarker:function(t){if(this.dialog){var e=this.activities.length;this.new_act_idx=this.markers.length,this.new_act_idx-e===1&&(this.markers.splice(this.new_act_idx-1,1),this.new_act_idx=this.new_act_idx-1),this.new_marker={Index:this.new_act_idx,LatLon:[t.latlng.lat,t.latlng.lng]},this.markers.push(this.new_marker)}},editMarker:function(t,e){this.editMarkerId=e,this.formMode=1,this.dialog=t},removeMarker:function(t){1===this.formMode&&(this.markers.splice(t,1),console.log(this.markers))}},watch:{}},J=F,B=(r("f66d"),Object(c["a"])(J,T,C,!1,null,"13abb8b6",null)),Z=B.exports;i["default"].use(d["a"]);var D=[{path:"/login",name:"login",component:b},{path:"/register",name:"register",component:$},{path:"/home",name:"home",component:Z}],H=new d["a"]({mode:"history",routes:D}),V=H,Y=r("ce5b"),G=r.n(Y);r("bf40");i["default"].use(G.a);var K={theme:{primary:"#1976D2",secondary:"#424242",accent:"#82B1FF",error:"#FF5252",info:"#2196F3",success:"#4CAF50",warning:"#FB8C00"}},Q=new G.a(K),W=r("2b27"),X=r.n(W),tt=r("2699"),et=r("a40a"),rt=r("4e2b"),it=r("31dc"),at=r("635f"),nt=r("2253"),ot=(r("6cc5"),r("e11e"));i["default"].config.productionTip=!1,i["default"].use(X.a),i["default"].use(d["a"]),i["default"].component("l-map",tt["a"]),i["default"].component("l-tile-layer",et["a"]),i["default"].component("l-marker",rt["a"]),i["default"].component("l-tooltip",it["a"]),i["default"].component("l-polyline",at["a"]),i["default"].component("l-control",nt["a"]),delete ot["Icon"].Default.prototype._getIconUrl,ot["Icon"].Default.mergeOptions({iconRetinaUrl:r("584d"),iconUrl:r("6397"),shadowUrl:r("e2b9")}),new i["default"]({router:V,vuetify:Q,render:function(t){return t(u)}}).$mount("#app")},6488:function(t,e,r){},7930:function(t,e,r){"use strict";r("6488")},"85ec":function(t,e,r){},9577:function(t,e,r){},d557:function(t,e,r){},e065:function(t,e,r){"use strict";r("d557")},f66d:function(t,e,r){"use strict";r("51b5")}});
//# sourceMappingURL=app.2d14be1b.js.map